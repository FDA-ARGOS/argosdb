{"ast":null,"code":"import _classCallCheck from\"/Users/smhsguest/projects/argosdb/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/smhsguest/projects/argosdb/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/smhsguest/projects/argosdb/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/smhsguest/projects/argosdb/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import Alertdialog from'./dialogbox';import Loadingicon from\"./loading_icon\";import*as LocalConfig from\"./local_config\";import{Chart}from\"react-google-charts\";import{Link}from\"react-router-dom\";import DoubleArrowOutlinedIcon from'@material-ui/icons/DoubleArrowOutlined';import{Markup}from'interweave';import $ from\"jquery\";import{sortReleaseList}from\"./util\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var verInfo={};var DatasetPage=/*#__PURE__*/function(_Component){_inherits(DatasetPage,_Component);var _super=_createSuper(DatasetPage);function DatasetPage(){var _this;_classCallCheck(this,DatasetPage);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={ver:\"\",tabidx:\"sampleview\",dialog:{status:false,msg:\"\"}};_this.handleDialogClose=function(){var tmpState=_this.state;tmpState.dialog.status=false;_this.setState(tmpState);};_this.handleVersion=function(){var ver=$(\"#verselector\").val();var reqObj={bcoid:_this.props.bcoId,dataversion:ver};_this.fetchPageData(reqObj);var tmpState=_this.state;tmpState.ver=ver;_this.setState(tmpState);};_this.handleTitleClick=function(e){var tmpState=_this.state;tmpState.tabidx=e.target.id.split(\"-\")[0];_this.setState(tmpState);};return _this;}_createClass(DatasetPage,[{key:\"componentDidMount\",value:function componentDidMount(){var reqObj={bcoid:this.props.bcoId,dataversion:this.props.initObj.dataversion};this.fetchPageData(reqObj);}},{key:\"fetchPageData\",value:function fetchPageData(reqObj){var _this2=this;var requestOptions={method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(reqObj)};var svcUrl=LocalConfig.apiHash.dataset_detail;fetch(svcUrl,requestOptions).then(function(res){return res.json();}).then(function(result){var tmpState=_this2.state;tmpState.response=result;tmpState.isLoaded=true;if(tmpState.response.status===0){tmpState.dialog.status=true;tmpState.dialog.msg=tmpState.response.error;}_this2.setState(tmpState);//console.log(\"Request:\",svcUrl);\nconsole.log(\"Ajax response:\",result);},function(error){_this2.setState({isLoaded:true,error:error});});}},{key:\"render\",value:function render(){if(!(\"response\"in this.state)){return/*#__PURE__*/_jsx(Loadingicon,{});}var resObj=this.state.response!==undefined?this.state.response:{};var extractObj=\"record\"in resObj?resObj.record.extract:undefined;var bcoObj=\"record\"in resObj?resObj.record.bco:undefined;var historyObj=\"record\"in resObj?resObj.record.history:undefined;var readMe=extractObj!==undefined?extractObj.readme:undefined;var downloadUrl=extractObj!==undefined?extractObj.downloadurl:undefined;var bcoTitle=extractObj!==undefined?extractObj.title:undefined;var bcoDescription=extractObj!==undefined?extractObj.description:undefined;var tabHash={\"sampleview\":{title:\"Sample View\",cn:\"\"},\"bcoview\":{title:\"BCO JSON\",cn:/*#__PURE__*/_jsx(\"pre\",{children:JSON.stringify(bcoObj,null,4)})},\"readme\":{title:\"README\",cn:/*#__PURE__*/_jsx(\"pre\",{children:readMe})},\"downloads\":{title:\"DOWNLOADS\",cn:/*#__PURE__*/_jsx(\"ul\",{style:{margin:\"20px 0px 100px 20px\"},children:/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:downloadUrl,className:\"reglink\",target:\"_\",children:\"Download dataset file\"})})})}};tabHash.sampleview.cn=\"\";if(extractObj!==undefined){if(extractObj.sampledata.type===\"table\"){tabHash.sampleview.cn=/*#__PURE__*/_jsx(Chart,{width:'100%',chartType:\"Table\",loader:/*#__PURE__*/_jsx(\"div\",{children:\"Loading Chart\"}),data:extractObj.sampledata.data,options:{showRowNumber:false,width:'100%',height:'100%'},rootProps:{'data-testid':'1'}});}else{//tabHash.sampleview.cn = (<div><pre>{extractObj.sampledata.data}</pre></div>);\ntabHash.sampleview.cn=/*#__PURE__*/_jsx(Markup,{content:extractObj.sampledata.data});}}var tabTitleList=[];var tabContentList=[];for(var tabId in tabHash){var activeFlag=tabId===this.state.tabidx?\"active\":\"\";var btnStyle={width:\"100%\",fontSize:\"15px\",color:\"#333\",border:\"1px solid #ccc\"};btnStyle.color=activeFlag===\"active\"?\"#990000\":\"#333\";btnStyle.background=activeFlag===\"active\"?\"#fff\":\"#eee\";btnStyle.borderBottom=activeFlag===\"active\"?\"1px solid #fff\":\"1px solid #ccc\";tabTitleList.push(/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",role:\"presentation\",style:{width:\"25%\"},children:/*#__PURE__*/_jsx(\"button\",{className:\"nav-link \"+activeFlag,id:tabId+\"-tab\",\"data-bs-toggle\":\"tab\",\"data-bs-target\":\"#sample_view\",type:\"button\",role:\"tab\",\"aria-controls\":\"sample_view-cn\",\"aria-selected\":\"true\",style:btnStyle,onClick:this.handleTitleClick,children:tabHash[tabId].title})},\"tab-\"+tabId));tabContentList.push(/*#__PURE__*/_jsx(\"div\",{className:\"tab-pane fade show  leftblock \"+activeFlag,id:tabId+\"-cn\",role:\"tabpanel\",\"aria-labelledby\":tabId+\"-tab\",style:{width:\"100%\",padding:\"20px\",background:\"#fff\"},children:tabHash[tabId].cn},\"formcn-\"+tabId));}var selectedFileName=\"\";var verSelector=\"\";if(historyObj!==undefined){var verOptions=[];//var verList = sortReleaseList(Object.keys(historyObj), false);\nvar verList=sortReleaseList(this.props.initObj.versionlist,false);var selectedVer=this.state.ver!==\"\"?this.state.ver.split(\".\").join(\"_\"):verList[0].split(\".\").join(\"_\");for(var i in verList){var ver=verList[i].split(\".\").join(\"_\");if(ver in historyObj){verInfo[ver]=historyObj[ver];}var verLbl=ver.split(\"_\").join(\".\");var lbl=\"version \"+verLbl+\" released on \"+verInfo[ver].release_date;lbl+=\" -- \"+verInfo[ver].id_count+\" record IDs \";if(verInfo[ver].ids_added>0){lbl+=\", \"+verInfo[ver].ids_added+\" added\";}else if(verInfo[ver].ids_removed>0){lbl+=\", \"+verInfo[ver].ids_removed+\" removed\";}verOptions.push(/*#__PURE__*/_jsx(\"option\",{value:verLbl,children:lbl}));}selectedFileName=\"Sample view for \"+verInfo[selectedVer].file_name;var s={width:\"50%\"};verSelector=/*#__PURE__*/_jsx(\"select\",{id:\"verselector\",className:\"form-select\",style:s,onChange:this.handleVersion,children:verOptions});}return/*#__PURE__*/_jsxs(\"div\",{className:\"pagecn\",children:[/*#__PURE__*/_jsx(Alertdialog,{dialog:this.state.dialog,onClose:this.handleDialogClose}),/*#__PURE__*/_jsxs(\"div\",{className:\"leftblock\",style:{width:\"100%\",margin:\"60px 0px 0px 0px\",fontSize:\"17px\",borderBottom:\"1px solid #ccc\"},children:[/*#__PURE__*/_jsx(DoubleArrowOutlinedIcon,{style:{color:\"#2358C2\",fontSize:\"17px\"}}),\"\\xA0\",/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"reglink\",children:\"HOME \"}),\"\\xA0 / \\xA0\",/*#__PURE__*/_jsx(Link,{to:\"/\"+this.props.bcoId,className:\"reglink\",children:this.props.bcoId})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"leftblock\",style:{width:\"100%\",margin:\"40px 0px 0px 0px\"},children:[/*#__PURE__*/_jsx(\"span\",{children:selectedFileName}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{children:verSelector}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:\"bold\"},children:bcoTitle}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{children:bcoDescription}),/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"leftblock\",style:{width:\"100%\",margin:\"20px 0px 0px 0px\"},children:[/*#__PURE__*/_jsx(\"ul\",{className:\"nav nav-tabs\",id:\"myTab\",role:\"tablist\",style:{width:\"50%\"},children:tabTitleList}),/*#__PURE__*/_jsx(\"div\",{className:\"tab-content\",id:\"myTabContent\",style:{width:\"100%\",margin:\"20px 0px 0px 0px\"},children:tabContentList})]})]});}}]);return DatasetPage;}(Component);export default DatasetPage;","map":{"version":3,"sources":["/Users/smhsguest/projects/argosdb/app/src/components/dataset_page.jsx"],"names":["React","Component","Alertdialog","Loadingicon","LocalConfig","Chart","Link","DoubleArrowOutlinedIcon","Markup","$","sortReleaseList","verInfo","DatasetPage","state","ver","tabidx","dialog","status","msg","handleDialogClose","tmpState","setState","handleVersion","val","reqObj","bcoid","props","bcoId","dataversion","fetchPageData","handleTitleClick","e","target","id","split","initObj","requestOptions","method","headers","body","JSON","stringify","svcUrl","apiHash","dataset_detail","fetch","then","res","json","result","response","isLoaded","error","console","log","resObj","undefined","extractObj","record","extract","bcoObj","bco","historyObj","history","readMe","readme","downloadUrl","downloadurl","bcoTitle","title","bcoDescription","description","tabHash","cn","margin","sampleview","sampledata","type","data","showRowNumber","width","height","tabTitleList","tabContentList","tabId","activeFlag","btnStyle","fontSize","color","border","background","borderBottom","push","padding","selectedFileName","verSelector","verOptions","verList","versionlist","selectedVer","join","i","verLbl","lbl","release_date","id_count","ids_added","ids_removed","file_name","s","fontWeight"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Alertdialog from './dialogbox';\nimport Loadingicon from \"./loading_icon\";\nimport * as LocalConfig from \"./local_config\";\nimport { Chart } from \"react-google-charts\";\nimport { Link } from \"react-router-dom\";\nimport DoubleArrowOutlinedIcon from '@material-ui/icons/DoubleArrowOutlined';\nimport { Markup } from 'interweave';\nimport $ from \"jquery\";\nimport {sortReleaseList} from \"./util\";\n\nvar verInfo = {};\n\nclass DatasetPage extends Component {\n  \n  state = {\n    ver:\"\",\n    tabidx:\"sampleview\",\n    dialog:{\n      status:false, \n      msg:\"\"\n    }\n  };\n\n  \n  handleDialogClose = () => {\n    var tmpState = this.state;\n    tmpState.dialog.status = false;\n    this.setState(tmpState);\n  }\n\n  handleVersion = () => {\n    var ver = $(\"#verselector\").val();\n    var reqObj = { bcoid:this.props.bcoId, dataversion:ver};\n    this.fetchPageData(reqObj);\n    var tmpState = this.state;\n    tmpState.ver = ver;\n    this.setState(tmpState);\n  }\n\n  componentDidMount() {\n      var reqObj = { bcoid:this.props.bcoId, dataversion:this.props.initObj.dataversion};\n      this.fetchPageData(reqObj); \n  \n  }\n\n\n\n  fetchPageData(reqObj){\n\n\n    const requestOptions = { \n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(reqObj)\n    };\n    const svcUrl = LocalConfig.apiHash.dataset_detail;\n\n    fetch(svcUrl, requestOptions)\n      .then((res) => res.json())\n      .then(\n        (result) => {\n          var tmpState = this.state;\n          tmpState.response = result;\n          tmpState.isLoaded = true;          \n          if (tmpState.response.status === 0){\n            tmpState.dialog.status = true;\n            tmpState.dialog.msg = tmpState.response.error;\n          }\n          this.setState(tmpState);\n          //console.log(\"Request:\",svcUrl);\n          console.log(\"Ajax response:\", result);\n        },\n        (error) => {\n          this.setState({\n            isLoaded: true,\n            error,\n          });\n        }\n      );\n  }\n\n\n  handleTitleClick = (e) => {\n\n    var tmpState = this.state;\n    tmpState.tabidx = e.target.id.split(\"-\")[0];\n    this.setState(tmpState);\n  };\n\n\n\n\n  render() {\n\n    if (!(\"response\" in this.state)){\n      return <Loadingicon/>\n    }\n    \n    const resObj = (this.state.response !== undefined ? this.state.response : {});\n    const extractObj = (\"record\" in resObj ? resObj.record.extract : undefined);\n    const bcoObj = (\"record\" in resObj ? resObj.record.bco : undefined);\n    const historyObj = (\"record\" in resObj ? resObj.record.history : undefined);\n   \n\n\n    var readMe = (extractObj !== undefined ? extractObj.readme : undefined); \n    var downloadUrl = (extractObj !== undefined ? extractObj.downloadurl : undefined);\n    var bcoTitle = (extractObj !== undefined ? extractObj.title : undefined);\n    var bcoDescription = (extractObj !== undefined ? extractObj.description : undefined);\n\n    var tabHash = {\n        \"sampleview\":{\n          title:\"Sample View\",\n          cn:\"\"\n        },\n        \"bcoview\":{\n          title:\"BCO JSON\",\n          cn:(<pre>{JSON.stringify(bcoObj, null, 4)}</pre>)\n        },\n        \"readme\":{\n          title:\"README\",\n          cn:(<pre>{readMe}</pre>)\n        },\n        \"downloads\":{\n          title:\"DOWNLOADS\",\n          cn:(\n            <ul style={{margin:\"20px 0px 100px 20px\"}}>\n              <li><Link to={downloadUrl} className=\"reglink\" target=\"_\">Download dataset file</Link></li>\n            </ul>\n          )\n        }\n      };\n\n      tabHash.sampleview.cn = \"\";    \n      if (extractObj !== undefined){\n        if(extractObj.sampledata.type === \"table\"){\n          tabHash.sampleview.cn = (\n            <Chart \n              width={'100%'}\n            chartType=\"Table\" \n            loader={<div>Loading Chart</div>}\n            data={extractObj.sampledata.data}\n            options={{showRowNumber: false, width: '100%', height: '100%'}}\n            rootProps={{ 'data-testid': '1' }}   \n            />\n          )\n        }\n        else{\n          //tabHash.sampleview.cn = (<div><pre>{extractObj.sampledata.data}</pre></div>);\n          tabHash.sampleview.cn = <Markup content={extractObj.sampledata.data}/>;\n        }  \n      }\n\n\n      var tabTitleList= [];\n      var tabContentList = [];\n      for (var tabId in tabHash){\n        var activeFlag = (tabId === this.state.tabidx ? \"active\" : \"\" );\n        var btnStyle = {width:\"100%\", fontSize:\"15px\", color:\"#333\", border:\"1px solid #ccc\"};\n        btnStyle.color = (activeFlag === \"active\" ? \"#990000\" : \"#333\");\n        btnStyle.background = (activeFlag === \"active\" ? \"#fff\" : \"#eee\");\n        btnStyle.borderBottom = (activeFlag === \"active\" ? \"1px solid #fff\" : \"1px solid #ccc\");\n        tabTitleList.push(\n          <li key={\"tab-\"+tabId} className=\"nav-item\" role=\"presentation\" \n            style={{width:\"25%\"}}>\n            <button className={\"nav-link \" + activeFlag} \n            id={tabId + \"-tab\"}  data-bs-toggle=\"tab\" \n            data-bs-target={\"#sample_view\"} type=\"button\" role=\"tab\" aria-controls={\"sample_view-cn\"} aria-selected=\"true\"\n            style={btnStyle} onClick={this.handleTitleClick}\n            >\n             {tabHash[tabId].title}  \n            </button>\n        </li>\n      );\n      tabContentList.push(\n        <div key={\"formcn-\"+tabId} \n          className={\"tab-pane fade show  leftblock \" + activeFlag} \n          id={tabId+\"-cn\"} role=\"tabpanel\" aria-labelledby={tabId + \"-tab\"}\n          style={{width:\"100%\",  padding:\"20px\", background:\"#fff\"}}>\n          {tabHash[tabId].cn}\n        </div>\n      );\n    }\n        \n    var selectedFileName = \"\";\n    var verSelector = \"\";\n    if (historyObj !== undefined){\n      var verOptions = [];\n      //var verList = sortReleaseList(Object.keys(historyObj), false);\n      var verList = sortReleaseList(this.props.initObj.versionlist, false);\n      var selectedVer = (this.state.ver !== \"\" ? this.state.ver.split(\".\").join(\"_\") : verList[0].split(\".\").join(\"_\"));\n      for (var i in verList ){\n        var ver = verList[i].split(\".\").join(\"_\");\n        if (ver in historyObj){\n            verInfo[ver] = historyObj[ver];\n        }\n        var verLbl = ver.split(\"_\").join(\".\") ;\n        var lbl = \"version \" + verLbl + \" released on \" + verInfo[ver].release_date \n        lbl += \" -- \" + verInfo[ver].id_count + \" record IDs \";\n        if (verInfo[ver].ids_added > 0){\n          lbl +=  \", \" + verInfo[ver].ids_added + \" added\";\n        }\n        else if (verInfo[ver].ids_removed > 0){\n          lbl +=  \", \" + verInfo[ver].ids_removed + \" removed\";\n        }\n        verOptions.push(<option value={verLbl}>{lbl}</option>);\n      }\n      selectedFileName = \"Sample view for \" + verInfo[selectedVer].file_name;\n      var s = {width:\"50%\"};\n      verSelector = (<select id=\"verselector\" className=\"form-select\" style={s} onChange={this.handleVersion}>{verOptions}</select>);\n    }\n\n\n    return (\n      <div className=\"pagecn\">\n        <Alertdialog dialog={this.state.dialog} onClose={this.handleDialogClose}/>\n\n        <div className=\"leftblock\" style={{width:\"100%\", \n          margin:\"60px 0px 0px 0px\", \n          fontSize:\"17px\", borderBottom:\"1px solid #ccc\"}}>\n          <DoubleArrowOutlinedIcon style={{color:\"#2358C2\", fontSize:\"17px\" }}/>\n          &nbsp;\n          <Link to=\"/\" className=\"reglink\">HOME </Link> \n            &nbsp; / &nbsp;\n          <Link to={\"/\"+this.props.bcoId} className=\"reglink\">{this.props.bcoId}</Link> \n        </div>\n        <div className=\"leftblock\" style={{width:\"100%\", margin:\"40px 0px 0px 0px\"}}>\n          <span>{selectedFileName}</span><br/>\n          <span>{verSelector}</span><br/>\n          <span style={{fontWeight:\"bold\"}}>{bcoTitle}</span><br/>\n          <span>{bcoDescription}</span><br/>\n        </div>\n\n        <div className=\"leftblock\" \n          style={{width:\"100%\", margin:\"20px 0px 0px 0px\"}}>\n          <ul className=\"nav nav-tabs\" id=\"myTab\" role=\"tablist\" style={{width:\"50%\"}}>\n            {tabTitleList}\n          </ul>\n          <div className=\"tab-content\" id=\"myTabContent\" \n            style={{width:\"100%\", margin:\"20px 0px 0px 0px\"}}>\n            {tabContentList}\n          </div>\n        </div>\n\n       \n\n        \n\n        \n      </div>\n    );\n  }\n}\n\nexport default DatasetPage;\n"]},"metadata":{},"sourceType":"module"}